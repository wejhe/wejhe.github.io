<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKUR - SKAI BCAS</title>
    <link rel="icon" type="image/x-icon" href="/img/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/css/bootstrap-datepicker.min.css" integrity="sha512-34s5cpvaNG3BknEWSuOncX28vz97bRI59UnVtEEpFX536A7BtZSJHsDyFoCl8S7Dt2TPzcrCEoHBGeM4SUBDBw==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
</head>
<body onload="showKuesioner()">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.10.0/js/bootstrap-datepicker.min.js" integrity="sha512-LsnSViqQyaXpD4mBBdRYeP6sRwJiJveh2ZIbW41EBrNmKxgr/LFZIiWT6yr+nycvhvauz8c2nYMhrP80YhG7Cw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/function.js"></script>

    <div class="container-fluid bg-light py-3">
        <div class="container">
            <div class="row">
                <div class="col text-start">
                    <a href="/home.html" id="home" class="btn btn-light" type="button"><i class="bi bi-house-door-fill me-2"></i></a>
                </div>
                <div class="col text-end">
                    <button id="logout" onclick="logout()" class="btn btn-danger me-2" type="button"><i class="bi bi-escape me-2"></i>Keluar</button>
                    <button class="btn btn-warning me-2" type="button" data-bs-toggle="modal" data-bs-target="#bantuan"><i class="bi bi-question-circle-fill me-2"></i>Bantuan</button>
                    <button class="btn btn-success" type="button" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Pastikan progress sudah 100% sebelum melakukan ekspor hasil AKUR"><i class="bi bi-envelope-arrow-down-fill me-2"></i>Ekspor Hasil AKUR</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid bg-dark py-3 fixed-bottom">
        <div class="container">
            <div class="row">
                <div class="col text-end">
                    <button onclick="location = '/coso3/kuesioner4.html'" class="btn btn-primary bg-gradient me-2" type="button"><i class="bi bi-arrow-left-circle-fill me-2"></i>Sebelumnya</button>
                </div>
                <div class="col text-center">
                    <select onchange="location = this.value;" class="form-select dropup" id="navigasi">
                        <option id="progressCOSO11" value="/coso1/kuesioner1.html">COSO 1 - Kuesioner 1</option>
                        <option id="progressCOSO12" value="/coso1/kuesioner2.html">COSO 1 - Kuesioner 2</option>
                        <option id="progressCOSO13" value="/coso1/kuesioner3.html">COSO 1 - Kuesioner 3</option>
                        <option id="progressCOSO14" value="/coso1/kuesioner4.html">COSO 1 - Kuesioner 4</option>
                        <option id="progressCOSO15" value="/coso1/kuesioner5.html">COSO 1 - Kuesioner 5</option>
                        <option id="progressCOSO16" value="/coso1/kuesioner6.html">COSO 1 - Kuesioner 6</option>
                        <option id="progressCOSO17" value="/coso1/kuesioner7.html">COSO 1 - Kuesioner 7</option>
                        <option id="progressCOSO21" value="/coso2/kuesioner1.html">COSO 2 - Kuesioner 1</option>
                        <option id="progressCOSO31" value="/coso3/kuesioner1.html">COSO 3 - Kuesioner 1</option>
                        <option id="progressCOSO32" value="/coso3/kuesioner2.html">COSO 3 - Kuesioner 2</option>
                        <option id="progressCOSO33" value="/coso3/kuesioner3.html">COSO 3 - Kuesioner 3</option>
                        <option id="progressCOSO34" value="/coso3/kuesioner4.html">COSO 3 - Kuesioner 4</option>
                        <option id="progressCOSO35" value="/coso3/kuesioner5.html" selected>COSO 3 - Kuesioner 5</option>
                        <option id="progressCOSO41" value="/coso4/kuesioner1.html">COSO 4 - Kuesioner 1</option>
                        <option id="progressCOSO42" value="/coso4/kuesioner2.html">COSO 4 - Kuesioner 2</option>
                        <option id="progressCOSO51" value="/coso5/kuesioner1.html">COSO 5 - Kuesioner 1</option>
                        <option id="progressCOSO52" value="/coso5/kuesioner2.html">COSO 5 - Kuesioner 2</option>
                    </select>
                </div>
                <div class="col text-start">
                    <button onclick="location = '/coso4/kuesioner1.html'" class="btn btn-primary bg-gradient me-2" type="button">Selanjutnya<i class="bi bi-arrow-right-circle-fill ms-2"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="bantuan" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5">Panduan Pengisian AKUR</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                    Seluruh data yang telah anda isikan pada formulir AKUR ini akan dihapus.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary">Hubungi Kami</button>
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid py-4">
        <div class="container">
            <div class="row">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <div class="form-text text-center text-black">Realisasi pencairan dana pembiayaan diikuti dengan dokumen-dokumen yang lengkap dan benar serta dilakukan pemantauan pemanfaatan dana agar sesuai dengan tujuan awal dan dituangkan dalam kartu debitur atau sejenis untuk diketahui oleh pimpinan cabang setempat</div>
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <div class="form-check form-switch d-inline-block align-middle">
                                        <input onchange="toggleKuesioner1(), formValidation1()" class="form-check-input mt-2" type="checkbox" role="switch" id="toggle1">
                                        <div class="form-text text-center">Sudah dilakukan? (N/Y)</div>
                                    </div>
                                </div>
                                <div id="buktiPelaksanaan1" class="mb-3">
                                    <div class="form-text mb-1">Bukti Pelaksanaan</div>
                                    <input onchange="formValidation1()" id="buktiPelaksanaan1Value" class="form-control form-control-sm" type="file">
                                </div>   
                                <div id="rencanaTindakLanjut1" class="mb-3">
                                    <div class="form-text mb-1">Rencana Tindak Lanjut</div>
                                    <textarea onchange="formValidation1()" id="rencanaTindakLanjut1Value" class="form-control" rows="3"></textarea>
                                </div>
                                <div id="targetPerbaikan1" class="mb-3">
                                    <div class="form-text mb-1">Target Perbaikan</div>
                                    <input onchange="formValidation1()" id="targetPerbaikan1Value" type="date" class="form-control form-control-sm" name="date">
                                </div>
                                <div class="d-grid">
                                    <button onclick="simpanData1()" id="simpan1" class="btn btn-primary" type="button" disabled>Simpan</button>
                                </div>
                                <div class="d-grid">
                                    <button onclick="resetData1()" id="reset1" class="btn btn-danger" type="button">Reset</button>
                                </div>
                                <script>
                                    toggleKuesioner1();
                                    loadData1();

                                    function formValidation1() {
                                        var toggle1 = document.getElementById("toggle1").checked;
                                        var buktiPelaksanaan1Value = document.getElementById("buktiPelaksanaan1Value");
                                        var rencanaTindakLanjut1Value = document.getElementById("rencanaTindakLanjut1Value");
                                        var targetPerbaikan1Value = document.getElementById("targetPerbaikan1Value");
                                        var simpan1 = document.getElementById("simpan1");

                                        if (toggle1 === true) {
                                            if(
                                                buktiPelaksanaan1Value.value.length > 0
                                            ) {
                                                simpan1.removeAttribute("disabled");
                                            } else {
                                                simpan1.setAttribute("disabled", true);
                                            }
                                        } else {
                                            if(
                                                rencanaTindakLanjut1Value.value.length > 0
                                                && targetPerbaikan1Value.value.length > 0
                                            ) {
                                                simpan1.removeAttribute("disabled");
                                            } else {
                                                simpan1.setAttribute("disabled", true);
                                            }
                                        }
                                    }

                                    function toggleKuesioner1() {
                                        var toggle1 = document.getElementById("toggle1").checked;
                                        var buktiPelaksanaan1 = document.getElementById("buktiPelaksanaan1");
                                        var rencanaTindakLanjut1 = document.getElementById("rencanaTindakLanjut1");
                                        var targetPerbaikan1 = document.getElementById("targetPerbaikan1");

                                        if (toggle1 === true) {
                                            buktiPelaksanaan1.removeAttribute("hidden");
                                            rencanaTindakLanjut1.setAttribute("hidden", true);
                                            targetPerbaikan1.setAttribute("hidden", true);
                                        } else {
                                            buktiPelaksanaan1.setAttribute("hidden", true);
                                            rencanaTindakLanjut1.removeAttribute("hidden");
                                            targetPerbaikan1.removeAttribute("hidden");
                                        }
                                    }

                                    function loadData1() {
                                        var toggle1 = document.getElementById("toggle1");
                                        var buktiPelaksanaan1 = document.getElementById("buktiPelaksanaan1");
                                        var rencanaTindakLanjut1 = document.getElementById("rencanaTindakLanjut1");
                                        var targetPerbaikan1 = document.getElementById("targetPerbaikan1");
                                        var buktiPelaksanaan1Value = document.getElementById("buktiPelaksanaan1Value");
                                        var rencanaTindakLanjut1Value = document.getElementById("rencanaTindakLanjut1Value");
                                        var targetPerbaikan1Value = document.getElementById("targetPerbaikan1Value");
                                        var simpan1 = document.getElementById("simpan1");
                                        var reset1 = document.getElementById("reset1");

                                        if (localStorage.getItem("item351") === "empty") {
                                            simpan1.removeAttribute("hidden");
                                            reset1.setAttribute("hidden", true);
                                        } else {
                                            var item = JSON.parse(localStorage.getItem("item351"));

                                            toggle1.checked = item.status;
                                            toggle1.setAttribute("disabled", true);
                                            toggleKuesioner1();

                                            buktiPelaksanaan1Value.remove();
                                            buktiPelaksanaan1.innerHTML += '<a href="' + item.bukti + '" target="_blank"><i class="bi bi-file-earmark-play-fill me-2"></i>' + item.namaBukti + '</a>';
                                            
                                            rencanaTindakLanjut1Value.value = item.rencana;
                                            rencanaTindakLanjut1Value.setAttribute("disabled", true);

                                            targetPerbaikan1Value.value = item.target;
                                            targetPerbaikan1Value.setAttribute("disabled", true);

                                            simpan1.setAttribute("hidden", true);
                                            reset1.removeAttribute("hidden");
                                            toggleKuesioner1();
                                        }
                                    }

                                    function getBase64(file, callback) {
                                        var reader = new FileReader();
                                        reader.readAsDataURL(file);
                                        reader.onload = function () {
                                            callback(reader.result);
                                        };
                                        reader.onerror = function (error) {
                                            console.log('Error: ', error);
                                        };
                                    }

                                    function simpanData1() {
                                        var simpanButton1 = document.getElementById("simpan1");
                                        simpanButton1.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            var toggle1 = document.getElementById("toggle1").checked;
                                            var buktiPelaksanaan1Value = document.getElementById("buktiPelaksanaan1Value").files[0];
                                            var rencanaTindakLanjut1Value = document.getElementById("rencanaTindakLanjut1Value").value;
                                            var targetPerbaikan1Value = document.getElementById("targetPerbaikan1Value").value;

                                            if (toggle1 === true) {
                                                var namaBukti = buktiPelaksanaan1Value.name;
                                                getBase64(buktiPelaksanaan1Value, function(base64String) {
                                                    var jsonString = '{"status":true, "namaBukti":"' + namaBukti + '", "bukti":"' + base64String + '", "rencana":"", "target":""}';
                                                    localStorage.setItem("item351", jsonString);
                                                    var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                    localStorage.setItem("progressCOSO35", ++prev);
                                                });
                                            } else {
                                                var jsonString = '{"status":false, "namaBukti":"", "bukti":"", "rencana":"' + rencanaTindakLanjut1Value + '", "target":"' + targetPerbaikan1Value + '"}';
                                                localStorage.setItem("item351", jsonString);
                                                var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                localStorage.setItem("progressCOSO35", ++prev);
                                            }

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }

                                    function resetData1() {
                                        var resetButton1 = document.getElementById("reset1");
                                        resetButton1.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            localStorage.setItem("item351", "empty");

                                            var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                            localStorage.setItem("progressCOSO35", --prev);

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }
                                </script>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <div class="form-text text-center text-black">Pemantauan pengolahan pembiayaan termasuk trade checking atau pemeriksaan silang data pengelola dilakukan dengan tepat dan benar untuk meyakini keabsahan dokumen-dokumen pendukung pembiayaan</div>
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <div class="form-check form-switch d-inline-block align-middle">
                                        <input onchange="toggleKuesioner2(), formValidation2()" class="form-check-input mt-2" type="checkbox" role="switch" id="toggle2">
                                        <div class="form-text text-center">Sudah dilakukan? (N/Y)</div>
                                    </div>
                                </div>
                                <div id="buktiPelaksanaan2" class="mb-3">
                                    <div class="form-text mb-1">Bukti Pelaksanaan</div>
                                    <input onchange="formValidation2()" id="buktiPelaksanaan2Value" class="form-control form-control-sm" type="file">
                                </div>   
                                <div id="rencanaTindakLanjut2" class="mb-3">
                                    <div class="form-text mb-1">Rencana Tindak Lanjut</div>
                                    <textarea onchange="formValidation2()" id="rencanaTindakLanjut2Value" class="form-control" rows="3"></textarea>
                                </div>
                                <div id="targetPerbaikan2" class="mb-3">
                                    <div class="form-text mb-1">Target Perbaikan</div>
                                    <input onchange="formValidation2()" id="targetPerbaikan2Value" type="date" class="form-control form-control-sm" name="date">
                                </div>
                                <div class="d-grid">
                                    <button onclick="simpanData2()" id="simpan2" class="btn btn-primary" type="button" disabled>Simpan</button>
                                </div>
                                <div class="d-grid">
                                    <button onclick="resetData2()" id="reset2" class="btn btn-danger" type="button">Reset</button>
                                </div>
                                <script>
                                    toggleKuesioner2();
                                    loadData2();

                                    function formValidation2() {
                                        var toggle2 = document.getElementById("toggle2").checked;
                                        var buktiPelaksanaan2Value = document.getElementById("buktiPelaksanaan2Value");
                                        var rencanaTindakLanjut2Value = document.getElementById("rencanaTindakLanjut2Value");
                                        var targetPerbaikan2Value = document.getElementById("targetPerbaikan2Value");
                                        var simpan2 = document.getElementById("simpan2");

                                        if (toggle2 === true) {
                                            if(
                                                buktiPelaksanaan2Value.value.length > 0
                                            ) {
                                                simpan2.removeAttribute("disabled");
                                            } else {
                                                simpan2.setAttribute("disabled", true);
                                            }
                                        } else {
                                            if(
                                                rencanaTindakLanjut2Value.value.length > 0
                                                && targetPerbaikan2Value.value.length > 0
                                            ) {
                                                simpan2.removeAttribute("disabled");
                                            } else {
                                                simpan2.setAttribute("disabled", true);
                                            }
                                        }
                                    }

                                    function toggleKuesioner2() {
                                        var toggle2 = document.getElementById("toggle2").checked;
                                        var buktiPelaksanaan2 = document.getElementById("buktiPelaksanaan2");
                                        var rencanaTindakLanjut2 = document.getElementById("rencanaTindakLanjut2");
                                        var targetPerbaikan2 = document.getElementById("targetPerbaikan2");

                                        if (toggle2 === true) {
                                            buktiPelaksanaan2.removeAttribute("hidden");
                                            rencanaTindakLanjut2.setAttribute("hidden", true);
                                            targetPerbaikan2.setAttribute("hidden", true);
                                        } else {
                                            buktiPelaksanaan2.setAttribute("hidden", true);
                                            rencanaTindakLanjut2.removeAttribute("hidden");
                                            targetPerbaikan2.removeAttribute("hidden");
                                        }
                                    }

                                    function loadData2() {
                                        var toggle2 = document.getElementById("toggle2");
                                        var buktiPelaksanaan2 = document.getElementById("buktiPelaksanaan2");
                                        var rencanaTindakLanjut2 = document.getElementById("rencanaTindakLanjut2");
                                        var targetPerbaikan2 = document.getElementById("targetPerbaikan2");
                                        var buktiPelaksanaan2Value = document.getElementById("buktiPelaksanaan2Value");
                                        var rencanaTindakLanjut2Value = document.getElementById("rencanaTindakLanjut2Value");
                                        var targetPerbaikan2Value = document.getElementById("targetPerbaikan2Value");
                                        var simpan2 = document.getElementById("simpan2");
                                        var reset2 = document.getElementById("reset2");

                                        if (localStorage.getItem("item352") === "empty") {
                                            simpan2.removeAttribute("hidden");
                                            reset2.setAttribute("hidden", true);
                                        } else {
                                            var item = JSON.parse(localStorage.getItem("item352"));

                                            toggle2.checked = item.status;
                                            toggle2.setAttribute("disabled", true);
                                            toggleKuesioner2();

                                            buktiPelaksanaan2Value.remove();
                                            buktiPelaksanaan2.innerHTML += '<a href="' + item.bukti + '" target="_blank"><i class="bi bi-file-earmark-play-fill me-2"></i>' + item.namaBukti + '</a>';
                                            
                                            rencanaTindakLanjut2Value.value = item.rencana;
                                            rencanaTindakLanjut2Value.setAttribute("disabled", true);

                                            targetPerbaikan2Value.value = item.target;
                                            targetPerbaikan2Value.setAttribute("disabled", true);

                                            simpan2.setAttribute("hidden", true);
                                            reset2.removeAttribute("hidden");
                                            toggleKuesioner2();
                                        }
                                    }

                                    function getBase64(file, callback) {
                                        var reader = new FileReader();
                                        reader.readAsDataURL(file);
                                        reader.onload = function () {
                                            callback(reader.result);
                                        };
                                        reader.onerror = function (error) {
                                            console.log('Error: ', error);
                                        };
                                    }

                                    function simpanData2() {
                                        var simpanButton2 = document.getElementById("simpan2");
                                        simpanButton2.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            var toggle2 = document.getElementById("toggle2").checked;
                                            var buktiPelaksanaan2Value = document.getElementById("buktiPelaksanaan2Value").files[0];
                                            var rencanaTindakLanjut2Value = document.getElementById("rencanaTindakLanjut2Value").value;
                                            var targetPerbaikan2Value = document.getElementById("targetPerbaikan2Value").value;

                                            if (toggle2 === true) {
                                                var namaBukti = buktiPelaksanaan2Value.name;
                                                getBase64(buktiPelaksanaan2Value, function(base64String) {
                                                    var jsonString = '{"status":true, "namaBukti":"' + namaBukti + '", "bukti":"' + base64String + '", "rencana":"", "target":""}';
                                                    localStorage.setItem("item352", jsonString);
                                                    var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                    localStorage.setItem("progressCOSO35", ++prev);
                                                });
                                            } else {
                                                var jsonString = '{"status":false, "namaBukti":"", "bukti":"", "rencana":"' + rencanaTindakLanjut2Value + '", "target":"' + targetPerbaikan2Value + '"}';
                                                localStorage.setItem("item352", jsonString);
                                                var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                localStorage.setItem("progressCOSO35", ++prev);
                                            }

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }

                                    function resetData2() {
                                        var resetButton2 = document.getElementById("reset2");
                                        resetButton2.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            localStorage.setItem("item352", "empty");

                                            var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                            localStorage.setItem("progressCOSO35", --prev);

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }
                                </script>
                            </form>
                        </div>
                    </div>  
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <form>
                                <div class="mb-3">
                                    <div class="form-text text-center text-black">Seluruh aset cabang terkontrol sejak saat pengajuan, pengolahan dan persetujuan, serta telah dikaji dengan baik dan benar untuk meyakini bahwa sumber pengembalian pembiayaan tetap berjalan dan jaminan yang diberikan tidak mengalami penurunan nilai</div>
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <div class="form-check form-switch d-inline-block align-middle">
                                        <input onchange="toggleKuesioner3(), formValidation3()" class="form-check-input mt-2" type="checkbox" role="switch" id="toggle3">
                                        <div class="form-text text-center">Sudah dilakukan? (N/Y)</div>
                                    </div>
                                </div>
                                <div id="buktiPelaksanaan3" class="mb-3">
                                    <div class="form-text mb-1">Bukti Pelaksanaan</div>
                                    <input onchange="formValidation3()" id="buktiPelaksanaan3Value" class="form-control form-control-sm" type="file">
                                </div>   
                                <div id="rencanaTindakLanjut3" class="mb-3">
                                    <div class="form-text mb-1">Rencana Tindak Lanjut</div>
                                    <textarea onchange="formValidation3()" id="rencanaTindakLanjut3Value" class="form-control" rows="3"></textarea>
                                </div>
                                <div id="targetPerbaikan3" class="mb-3">
                                    <div class="form-text mb-1">Target Perbaikan</div>
                                    <input onchange="formValidation3()" id="targetPerbaikan3Value" type="date" class="form-control form-control-sm" name="date">
                                </div>
                                <div class="d-grid">
                                    <button onclick="simpanData3()" id="simpan3" class="btn btn-primary" type="button" disabled>Simpan</button>
                                </div>
                                <div class="d-grid">
                                    <button onclick="resetData3()" id="reset3" class="btn btn-danger" type="button">Reset</button>
                                </div>
                                <script>
                                    toggleKuesioner3();
                                    loadData3();

                                    function formValidation3() {
                                        var toggle3 = document.getElementById("toggle3").checked;
                                        var buktiPelaksanaan3Value = document.getElementById("buktiPelaksanaan3Value");
                                        var rencanaTindakLanjut3Value = document.getElementById("rencanaTindakLanjut3Value");
                                        var targetPerbaikan3Value = document.getElementById("targetPerbaikan3Value");
                                        var simpan3 = document.getElementById("simpan3");

                                        if (toggle3 === true) {
                                            if(
                                                buktiPelaksanaan3Value.value.length > 0
                                            ) {
                                                simpan3.removeAttribute("disabled");
                                            } else {
                                                simpan3.setAttribute("disabled", true);
                                            }
                                        } else {
                                            if(
                                                rencanaTindakLanjut3Value.value.length > 0
                                                && targetPerbaikan3Value.value.length > 0
                                            ) {
                                                simpan3.removeAttribute("disabled");
                                            } else {
                                                simpan3.setAttribute("disabled", true);
                                            }
                                        }
                                    }

                                    function toggleKuesioner3() {
                                        var toggle3 = document.getElementById("toggle3").checked;
                                        var buktiPelaksanaan3 = document.getElementById("buktiPelaksanaan3");
                                        var rencanaTindakLanjut3 = document.getElementById("rencanaTindakLanjut3");
                                        var targetPerbaikan3 = document.getElementById("targetPerbaikan3");

                                        if (toggle3 === true) {
                                            buktiPelaksanaan3.removeAttribute("hidden");
                                            rencanaTindakLanjut3.setAttribute("hidden", true);
                                            targetPerbaikan3.setAttribute("hidden", true);
                                        } else {
                                            buktiPelaksanaan3.setAttribute("hidden", true);
                                            rencanaTindakLanjut3.removeAttribute("hidden");
                                            targetPerbaikan3.removeAttribute("hidden");
                                        }
                                    }

                                    function loadData3() {
                                        var toggle3 = document.getElementById("toggle3");
                                        var buktiPelaksanaan3 = document.getElementById("buktiPelaksanaan3");
                                        var rencanaTindakLanjut3 = document.getElementById("rencanaTindakLanjut3");
                                        var targetPerbaikan3 = document.getElementById("targetPerbaikan3");
                                        var buktiPelaksanaan3Value = document.getElementById("buktiPelaksanaan3Value");
                                        var rencanaTindakLanjut3Value = document.getElementById("rencanaTindakLanjut3Value");
                                        var targetPerbaikan3Value = document.getElementById("targetPerbaikan3Value");
                                        var simpan3 = document.getElementById("simpan3");
                                        var reset3 = document.getElementById("reset3");

                                        if (localStorage.getItem("item353") === "empty") {
                                            simpan3.removeAttribute("hidden");
                                            reset3.setAttribute("hidden", true);
                                        } else {
                                            var item = JSON.parse(localStorage.getItem("item353"));

                                            toggle3.checked = item.status;
                                            toggle3.setAttribute("disabled", true);
                                            toggleKuesioner3();

                                            buktiPelaksanaan3Value.remove();
                                            buktiPelaksanaan3.innerHTML += '<a href="' + item.bukti + '" target="_blank"><i class="bi bi-file-earmark-play-fill me-2"></i>' + item.namaBukti + '</a>';
                                            
                                            rencanaTindakLanjut3Value.value = item.rencana;
                                            rencanaTindakLanjut3Value.setAttribute("disabled", true);

                                            targetPerbaikan3Value.value = item.target;
                                            targetPerbaikan3Value.setAttribute("disabled", true);

                                            simpan3.setAttribute("hidden", true);
                                            reset3.removeAttribute("hidden");
                                            toggleKuesioner3();
                                        }
                                    }

                                    function getBase64(file, callback) {
                                        var reader = new FileReader();
                                        reader.readAsDataURL(file);
                                        reader.onload = function () {
                                            callback(reader.result);
                                        };
                                        reader.onerror = function (error) {
                                            console.log('Error: ', error);
                                        };
                                    }

                                    function simpanData3() {
                                        var simpanButton3 = document.getElementById("simpan3");
                                        simpanButton3.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            var toggle3 = document.getElementById("toggle3").checked;
                                            var buktiPelaksanaan3Value = document.getElementById("buktiPelaksanaan3Value").files[0];
                                            var rencanaTindakLanjut3Value = document.getElementById("rencanaTindakLanjut3Value").value;
                                            var targetPerbaikan3Value = document.getElementById("targetPerbaikan3Value").value;

                                            if (toggle3 === true) {
                                                var namaBukti = buktiPelaksanaan3Value.name;
                                                getBase64(buktiPelaksanaan3Value, function(base64String) {
                                                    var jsonString = '{"status":true, "namaBukti":"' + namaBukti + '", "bukti":"' + base64String + '", "rencana":"", "target":""}';
                                                    localStorage.setItem("item353", jsonString);
                                                    var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                    localStorage.setItem("progressCOSO35", ++prev);
                                                });
                                            } else {
                                                var jsonString = '{"status":false, "namaBukti":"", "bukti":"", "rencana":"' + rencanaTindakLanjut3Value + '", "target":"' + targetPerbaikan3Value + '"}';
                                                localStorage.setItem("item353", jsonString);
                                                var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                                localStorage.setItem("progressCOSO35", ++prev);
                                            }

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }

                                    function resetData3() {
                                        var resetButton3 = document.getElementById("reset3");
                                        resetButton3.innerHTML += '<div class="spinner-border spinner-border-sm text-light ms-2" role="status"><span class="visually-hidden"></span></div>';

                                        sleep(2000).then(() => {
                                            localStorage.setItem("item353", "empty");

                                            var prev = parseInt(localStorage.getItem("progressCOSO35"));
                                            localStorage.setItem("progressCOSO35", --prev);

                                            window.open("/coso3/kuesioner5.html","_self");
                                        })
                                    }
                                </script>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br><br><br><br>
</body>
</html>